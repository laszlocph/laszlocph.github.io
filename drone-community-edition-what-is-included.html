<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Hi I'm Laszlo Fogas, Devops consultant. My mission is elevating team cultures through automation and tooling. As a former engineering director I gained the perspective to effectively operate on many levels of your organization. I feel home in developer advocacy, building CI/CD pipelines and Cloud infrastructure, up to stakeholder management.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta content="Drone Community Edition - what is included?" property="og:title">
  <meta content="website" property="og:type">
  <meta content="/images/1500x500.jpg" property="og:image">
  <meta content="/laszlo.jpg" property="og:image">
  <meta content="/drone-community-edition-what-is-included" property="og:url">
  <meta content="Laszlo Fogas" property="og:site_name">
  <meta content="The licensing of Drone 1.0 left a few questions open. In this article I capture what I know about the Drone Community Edition and my experience building the opensource version." property="og:description">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@laszlocph">
  <meta name="twitter:creator" content="@laszlocph">
  <meta name="twitter:title" content="Drone Community Edition - what is included?">
  <meta name="twitter:description" content="The licensing of Drone 1.0 left a few questions open. In this article I capture what I know about the Drone Community Edition and my experience building the opensource version.">
  <meta name="twitter:image" content="/images/1500x500.jpg">

  <title>Drone Community Edition - what is included? - Laszlo Fogas</title>
  <link rel="stylesheet" href="css/main.css">
  <meta name="google-site-verification" content="rRfVaMDPujw_KMAWJY0A3P6wZ3uP8pg2_-Bp0nAbLqg" />
<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1781114255487972'); // Insert your pixel ID here.
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1781114255487972&ev=PageView&noscript=1"
/></noscript>
<!-- DO NOT MODIFY -->
<!-- End Facebook Pixel Code -->

</head>
<body style="position: relative">
  <div class="container">
    <h1><a href="./">Laszlo Fogas</a></h1>
    <img src="images/1500x500.jpg"/>

    <h2 id="drone-community-edition---what-is-included">Drone Community Edition - what is included?</h2>

<p>2019-03-21</p>

<p>I’ve been using Drone 0.8 extensively for 18 months now and enjoyed great success with it.</p>

<p>Drone 1.0 is tagged now on Github and there are a few licensing changes that are worth noting.</p>

<blockquote>
  <p>Warning. I’m no expert on OSS licensing, consult with your legal advisor before you do things based on information published in this blog post.</p>
</blockquote>

<h3 id="the-licensing-landscape-is-rather-confusing">The licensing landscape is rather confusing</h3>

<p>There is information scattered in source code, the Discourse forum and various FAQs and at times they hold conflicting information.</p>

<p>There is a recent <a href="https://discourse.drone.io/t/drone-community-edition/3938" target="\_blank">Discourse thread</a> on it where Brad cleared up some of my concerns.</p>

<p><br />
<img src="images/drone-licensing.png" alt="Drone.io licensing" /></p>

<h3 id="source-code-trumps-everything-in-licensing-questions">Source code trumps everything in licensing questions</h3>

<p>Brad was clear on this one. The source code has the final say of what is part of the drone.io Community Edition.</p>

<p>Since Docker Hub holds the enterprise version going forward, the <code class="highlighter-rouge">drone/drone:1</code> image will have resource limits or it may raise licensing questions that I have no intent to figure out.</p>

<p>Instead I build the code from source to get the pure OSS version: <code class="highlighter-rouge">go build --tags oss github.com/drone/drone/cmd/drone-server</code></p>

<p>The command results in a <code class="highlighter-rouge">drone-server</code> binary that I can start after setting the right environment variables:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DRONE_GITHUB_SERVER=https://github.com \
DRONE_GITHUB_CLIENT_ID=xxx \
DRONE_GITHUB_CLIENT_SECRET=xxx \
DRONE_SERVER_HOST=mydomain.com \
DRONE_SERVER_PROTO=http \
DRONE_USER_CREATE=username:yourgithubusername,admin:true \
DRONE_USER_FILTER=yourgithubusername \
DRONE_LOGS_DEBUG=true \
./drone-server
</code></pre></div></div>

<h3 id="there-are-no-agents-in-the-community-edition">There are no agents in the Community Edition</h3>

<p>Surprisingly agents are not part of the Community Edition.</p>

<p>While the server node can run builds and Drone works in a single node setup, scaling requires the purchase and Enterprise license (or fit in the low volume Drone usage to use the Enterprise version for free).</p>

<p>TI tried building the <code class="highlighter-rouge">drone-agent</code> binary from source and could confirm that is not part of the OSS license.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  drone git:(master) ✗ go build --tags oss github.com/drone/drone/cmd/drone-agent

can't load package: package github.com/drone/drone/cmd/drone-agent: build constraints exclude all Go files in /home/laszlo/projects/drone/cmd/drone-agent
</code></pre></div></div>

<p>Luckilly the <code class="highlighter-rouge">github.com/drone/drone/cmd/drone-agent</code> package is only a thin layer on top of the runner architecture of Drone. The runner source code is part of the Community Edition which we saw earlier when the single node setup ran builds.</p>

<h3 id="the-kubernetes-integration-is-not-part-of-the-community-edition">The Kubernetes integration is not part of the Community Edition</h3>

<p>The same is true about the Kubernetes native builds.</p>

<p>Only a <a href="https://github.com/drone/drone/blob/master/scheduler/kube/kube_oss.go" target="\_blank">“noop” implementation</a> is tagged with <code class="highlighter-rouge">// +build oss</code> thus when you build with <code class="highlighter-rouge">go build --tags oss</code> all you get is pending builds when you try enabling the Kubernetes scheduler.</p>

<h3 id="what-is-the-drone-community-edition-is-good-for-then">What is the Drone Community Edition is good for then?</h3>

<p>Smaller agentless single node setups where the price of running a node 24/7 is not prohibiting.</p>

<p>Price sensitivity varies a lot, some may run a 16 core node and don’t mind the price, but the Community Edition does not scale infinitely.</p>

<p>At least not today. Drone is famous for the clean code and interfaces, I wouldn’t be surprised if community maintained schedulers pop up.</p>

<p>UPDATE:</p>
<ul>
  <li>Also no TLS</li>
  <li>And only SQLite, no Postgres or MySQL backends</li>
  <li>The Enterprise license got cleared up in the meantime. Basically Enterprise is free under 15000 builds a year, no questions asked. It is also free above that limit in a bunch of scenarios. If no special case applies to you than above 15000 builds a year it has a per-user pricing model. <a href="https://discourse.drone.io/t/licensing-and-subscription-faq/3839">Reference</a></li>
</ul>

<p>UPDATE2:</p>
<ul>
  <li>I decided to fork 0.8 and add my opinions. Github, Kubernetes, and other goodies in focus. <a href="https://github.com/laszlocph/drone-oss-08/">It’s on Github</a></li>
</ul>

    <br/>
    <hr/>
    <p>Read some more about Actions or Drone:</p>

    <ul>
      
        
          <li>
            <a href="/builing-docker-images-with-github-actions">Builing Docker images with Github Actions (2019-09-02)</a>
          </li>  
        
      
        
          <li>
            <a href="/setting-gopath-in-github-actions-revisited">Setting GOPATH in Github Actions - revisited (2019-08-29)</a>
          </li>  
        
      
        
          <li>
            <a href="/setting-gopath-in-github-actions">Setting GOPATH in Github Actions (2019-08-28)</a>
          </li>  
        
      
        
          <li>
            <a href="/drone-oss-08-devlog-1">DroneOSS08 Devlog &#x23;1 (2019-04-24)</a>
          </li>  
        
      
        
          <li>
            <a href="/drone-environment-variables-three-tips">Drone Environment Variables - Three tips (2019-03-26)</a>
          </li>  
        
      
        
          <li>
            <a href="/drone-community-edition-what-is-included">Drone Community Edition - what is included? (2019-03-21)</a>
          </li>  
        
      
        
          <li>
            <a href="/the-ultimate-droneci-caching-guide">The ultimate DroneCI caching guide (2019-02-28)</a>
          </li>  
        
      
        
          <li>
            <a href="/how-using-cache-from-can-speed-up-your-docker-builds-in-droneci">How using cache-from can speed up your Docker builds in DroneCI (2019-02-20)</a>
          </li>  
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </ul>

    <hr/>
    <br/>
    <p>I can also notify you if there is a new Drone related article. Won't spam you, I promise.</p>
    <script async>(function(s,u,m,o,j,v){j=u.createElement(m);v=u.getElementsByTagName(m)[0];j.async=1;j.src=o;j.dataset.sumoSiteId='bb30a2ae7497e8dbaf05162b58e3ecc5282a86f6253cc4e12d53849356709a95';v.parentNode.insertBefore(j,v)})(window,document,'script','//load.sumo.com/');</script>
    <span data-sumome-listbuilder-embed-id="936e7bcc0122906987a873e44345a0faca428e80fe0ba846f5a221d5ddec5417"></span>
  </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84825803-1', 'auto');
  ga('send', 'pageview');

</script>

<!-- Twitter universal website tag code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
// Insert Twitter Pixel ID and Standard Event data below
twq('init','nxlen');
twq('track','PageView');
</script>
<!-- End Twitter universal website tag code -->

</body>
</html>
